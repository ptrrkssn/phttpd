<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.03 [en] (X11; I; SunOS 5.5.1 sun4m) [Netscape]">
   <TITLE>Phttpd: phttpd.conf
</TITLE>
</HEAD>
<BODY>

<CENTER>
<H2>
Configuring "phttpd.conf"</H2></CENTER>
The "phttpd.conf" file (normally located in /opt/phttpd/etc/) contains
some settings that affect the global state of the server. Most of these
settings can normally be ignored since they are automatically given reasonable
defaults. However, there are a couple of important ones that you probably
must and should modify.

<P>First there are some general remarks about the server. phttpd can run
in several modes:
<OL>
<LI>
Single Standalone Server, which may bind to one or all of you network interfaces.
This is the default mode of operation.</LI>

<LI>
phttpd support multihoming in a very nice and low-resource mode. The mode
is called "rkmultimode" in the global configuration file. This requiers
the server to listen on ALL of your network interfaces, and the server
has a sperate document root and configurable modules with different options
each for every interface you have.</LI>

<LI>
phttpd support "software virtual servers", as specified in HTTP/1.1 and
also this mode of operation in the HTTP/1.0 emulation mode. This work with
most of the modern browsers, e.g. NetScape 3.x and above. There is a different
document root for every virtual server and there may also be different
modules loaded for each virtual server.</LI>

<LI>
In addition, modes 2 and 3 can be combined. Thus giving you the option
of running a bunch of different software virtual servers on each network
interface. A network interface may also be a virtual interface. How to
set up a virtual interface on Solaris 2.5+ is documentet in <I>man ifconfig.</I></LI>
</OL>
The first one is the logical name of the server, which unless modified,
defaults to the hostname of the machine the server is run on. For example:
<PRE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server-name = www.some.where</PRE>
The next one is the WebMaster contact information, which is included into
error messages generated by the server. For example:
<PRE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; web-admin-name&nbsp; = Foo Barson
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; web-admin-home&nbsp; = http://www.some.where/~foo/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; web-admin-email = foo@some.where</PRE>

<H3>
Configuration options:</H3>

<DL>
<DT>
<B>server-name</B> (string)</DT>

<DD>
The full DNS name of the server that you want it to be known as. Defaults
to the hostname of the machine.</DD>

<DT>
<B>server-addr</B> (string)</DT>

<DD>
The DNS name or IP number of the local interface to bind the server to.
Defaults to "*" which causes it to bind to all local interfaces. In case
you want to use <I><B>rkmultimode</B>, </I>you must set this to "*" !</DD>

<DT>
<B>server-port</B> (string)</DT>

<DD>
The service name or number of the TCP port to bind the server to. Defaults
to port 80 (the standard WWW port).</DD>

<DT>
<B>server-user</B> (string)</DT>

<DD>
The user name or number that the server should execute as. This will also
cause the <B>server-group</B> option to be set to the group number defined
in the password database for the specific user.</DD>

<DT>
<B>server-group</B> (string)</DT>

<DD>
The group name or number that the server should execute as.</DD>

<DT>
<B>rkmultimode</B> (boolean)</DT>

<DL>This enables the use of different document roots for every networkinterface.
To make this work you must also set <B>server-addr</B> to "*". The documentroots
are automatically defined by the <B>database-dir</B>(see below) and the
<B>IP-number</B> of the interface in <B>hexadecimal notation !</B> By default
this option is <B>off</B>.Let me give you an example: If you have the network
interfaces <B>192.168.10.12 </B>and <B>192.168.10.15</B> on your machine
and you <B>database-dir</B> is /home/www/pages, the document roots will
be:
<UL>
<LI>
<B>/home/www/pages/c0a80a0c</B> for request to the interface <B>192.168.10.12</B></LI>

<LI>
<B>/home/www/pages/c0a80a0f</B> for request to the interface <B>192.168.10.15</B></LI>
</UL>
If you are working with cgi's or checking the logfile, phttpd will internally
handle those requests by expanding the requested <B>URL</B> with that <B>hexadecimal</B>
number as a prefix. So if you ask for the <B>URL</B> <U>http://192.168.10.12/demo/index.hml</U>
the server will handle this as a request to <B>/c0a80a0c/demo/index.html</B>
<BR>You will also see that URL in you logfile. To split that log into seperate
logs, issue the following shell command:
<DL>grep <B>c0a80a0c </B>your-logfile | sed s/'\/c0a80a0c// > log.192.168.10.12</DL>
<B><U>Note:</U></B> A future release will allow you to use hostnames instead
of ip numbers.</DL>
<B>software-virtual-server</B> (boolean)
<DL>This enables the use of software virtual servers as defined in HTTP/1.1.
In principal this means, that you have several DNS-entries point to the
same IP-address and depending on the query, the server will use a different
document root for all those entries. This works the same way as <B>rkmultimode</B>,
but the hostname in <I>lowercase</I> is sent to phttpd is prefixed to the
URL. For proper work, this may requiere some symbolic link, if you want
to have more names to the same server of qualified and unqualified named
pointing to the same data. This applies to the modules as well.
<BR>This mode can be combined with <B>rkmultimode</B>. The <B>rkmultimode</B>
comes FIRST !.
<BR>The internal representation then is something like: /<B>c0a80a0c/myhostname/demo/index.html</B>
for a query
<BR><I>GET&nbsp;http://myhostname/demo/index.html HTTP/1.1</I></DL>

<DT>
<B>web-admin-name</B> (string)</DT>

<DD>
Full name of the server administrator.</DD>

<DT>
<B>web-admin-home</B> (string)</DT>

<DD>
URL to the server administrators home page.</DD>

<DT>
<B>web-admin-email</B> (string)</DT>

<DD>
Email address to the server administrator.</DD>

<DT>
<B>url-rewrites</B> (table)</DT>

<DD>
A list of rewriting rules for incoming URLs.</DD>

<DT>
<B>url-redirects</B> (table)</DT>

<DD>
A list of temporarily redirected URLs.</DD>

<DT>
<B>url-permanent-redirects</B> (table)</DT>

<DD>
A list of permanently redirected URLs.</DD>

<DT>
<B>url-access</B> (table)</DT>

<DD>
A list of host access control rules.</DD>

<DT>
<B>read-authenticate</B> (table)</DT>

<DD>
A list of user/password authentication rules for get/post/head requests.</DD>

<DT>
<B>write-authenticate</B> (table)</DT>

<DL>
<DT>
A list of user/password authentication rules for HTTP-put requests (like
http-publish).</DT>
</DL>

<DT>
<B>write-needs-auth</B> (boolean)</DT>

<DL>
<DT>
Defaults to yes. This forces all HTTP-put requests to be authentificated.</DT>
</DL>

<DT>
<B>url-handlers</B> (table)</DT>

<DL>
<DT>
A list of Phttpd Modules to be invoked for various URLs.</DT>
</DL>

<DT>
<B>database-dir</B> (string)</DT>

<DL>
<DT>
The directory where the global HTML documents are located. Defaults to
the directory "/opt/phttpd/db".</DT>
</DL>

<DT>
<B>modules-dir</B> (string)</DT>

<DD>
The directory where the Phttpd Modules are located. Defaults to the directory
"/opt/phttpd/modules".</DD>

<DT>
<B>user-dir</B> (string)</DT>

<DD>
The subdirectory in the user's home directory where their HTML documents
are located. Defaults to ".public".</DD>

<DT>
<B>logging-file</B> (string)</DT>

<DD>
Path to the request logging file. This file is written in the CERN Common
Log format. Defaults to "/var/log/phttpd/requests".</DD>

<DT>
<B>counting-file</B> (string)</DT>

<DD>
Path to the request counting file. This file is written in a NDBM format
for speedy access. Defaults to "/var/log/phttpd/counts".</DD>

<DT>
<B>pid-file</B> (string)</DT>

<DD>
Path to a file containing the process ID of the Phttpd daemon.</DD>

<DT>
<B>stderr-file</B> (string)</DT>

<DD>
Path to a file containing all <B>stderr</B> output from CGI scripts.</DD>

<DT>
<B>concurrency</B> (number)</DT>

<DD>
A number specifying the desired thread concurrency level.</DD>

<DT>
<B>listen-backlog</B> (number)</DT>

<DD>
A number specifying the desired TCP/IP new connection requests backlog
limit.</DD>

<DT>
<B>socket-sndbuf</B> (number)</DT>

<DD>
The size of the transmit buffer for each request.</DD>

<DT>
<B>socket-rcvbuf</B> (number)</DT>

<DD>
The size of the receive buffer for each request.</DD>

<DT>
<B>gc-time</B> (number)</DT>

<DD>
The maximum time a request may be idle.</DD>

<DT>
<B>gc-sleep</B> (number)</DT>

<DD>
The time between each request garbage collect run.</DD>

<DT>
<B>select-timeout</B> (number)</DT>

<DD>
The maximum time to wait for incoming data.</DD>

<DT>
<B>stack-size</B> (number)</DT>

<DD>
The size of the stack for each thread.</DD>

<DT>
<B>fscache-refresh</B> (number)</DT>

<DT>
<B>fscache-ttl</B> (number)</DT>

<DT>
<B>fscache-gc-interval</B> (number)</DT>

<DD>
Controls how long entries live in the FileSystem cache.</DD>

<DT>
<B>urlcache-refresh</B> (number)</DT>

<DT>
<B>urlcache-ttl</B> (number)</DT>

<DT>
<B>urlcache-gc-interval</B> (number)</DT>

<DD>
Controls how long entries live in the URL lookup cache.</DD>

<DT>
<B>server-processes</B> (number)</DT>

<DD>
The number of parallell server processes doing accept() concurrently.</DD>

<BR><I>Warning: This does NOT work reliably under Solaris 2.4</I>
<DT>
<B>accept-threads</B> (number)</DT>

<DD>
The number of threads concurrently waiting for incoming connections.</DD>

<H4>
Boolean variables</H4>

<DT>
<B>bound-threads</B> (boolean)</DT>

<DD>
If set to "true", use bound threads instead of unbound threads.</DD>

<DT>
<B>hostname-lookups</B> (boolean)</DT>

<DD>
If set to "true", do hostname lookups for each incoming connection.</DD>
</DL>

<HR>
<FONT SIZE=+2> /opt/phttpd/etc/phttpd.conf sample configuration </FONT> 
<P></P>
<PRE>
# /opt/phttpd/etc/phttpd.conf
#
# Sample configuration for PHTTPD 1.0x
# 

# web-admin-name = Foo Barson
# web-admin-home = http://www.xx.yy/~fubar/
# web-admin-email = fubar@xx.yy

database-dir   = /opt/phttpd/db
# user-dir       = pub
# user-basedir   = [null]
#
# fscache-refresh = 10
# fscache-ttl    = 60
# fscache-gc-interval = 60
#
# urlcache-refresh = 120
# urlcache-ttl   = 120
# urlcache-gc-interval = 600
#
# accept-threads = 1
# server-name    = www.ifm.liu.se
server-port    = 80
server-addr    = *
#modules-dir    = /opt/phttpd/modules
# server-user    = www
# server-group   = nobody
# concurrency    = 64
# socket-sndbuf  = 64K
# socket-rcvbuf  = 64K
# gc-time        = 120
# gc-sleep       = 60
# select-timeout = 120
# stack-size     = 2M
# logging-file   = /var/log/phttpd/requests
# stderr-file   = /var/log/phttpd/stderr
# pid-file       = /var/log/phttpd/pid

### Max length of input URL. 0 == unlimited
# max-url-size   = 256K

### Multiserver support, added by Roland Kaltefleiter, which requiers
### only ONE Proceess, set this to on, to enable, default is no.
### This option requirs a bind to ANY (server-addr = * )
### The files for the virtual servers will be put below 
### database-dir/HEX-IP/, that means the IP-Number of each interface
### will be added to the pathname, (using %lx format).
#
# rkmultimode = no

### Software virtual servers as defined in HTTP/1.1
### If you use this, you need to take real care if you use some of
### the proxy code, since a local request might be 'GET http://host/path HTTP/1.0'
### The virtualhostname is put behind the Server root.
### In combination with 'rkmultimode', rkmultimode comes first, and then
### software-virtual-server. So a documentroot will then be like:
### /home/www/docs/c1626e12/www.netuse.de/
### Warning: software-virtual-server is verified for the modules:
### dir.so file.so cgi.so map.so
### Wont'work: All proxy code AND ncsa-html.so.
### All others: Should work, but I did not have time to verify....
#
# software-virtual-server = no

### You may wanna disable this if you have problems with small files
### and images (<60 bytes) and Netscape 2.0b (there are bugs in NS2's
### handling of Keep-Alive connections and small objects).
#
# keepalive-connections = yes

### By enabling "extended-logging" you will get two extra fields in the
### requests log file, "Referer" and "User-Agent".
#
# extended-logging = yes

### Add the received and send bytes of the query and the mime-header to
### the volume written to the logging-file. Old default was NOT to add.
### The incoming header is always added (if logheadervolume==yes).
### The outgoing mimeheader is added only by the modules file and cgi.
### Other modules are in work.....
#
# logheadervolume = yes

### This will enable IP# -> Hostname lookups. This can cause a performance
### penalty even though Phttpd tries to limit the effects of it by doing
### extensive cacheing
#
# hostname-lookups = yes

### This will enable IDENT (RFC1413) queries for every incoming request.
### WARNING: This will cause a big performance penalty, even though Phttpd
### does the lookup in the background to try to limit the effects.
#
# ident-lookups = no

### (See the INSTALL file for more information about this parameter if you
###  want to set this value to anything above 5 (which you want) _and_ have
###  the OS use it! It won't hurt to have it set to this though...)
#
# listen-backlog = 1024


#
# List of global modules to load at startup
#
#global-modules = {
#	extra_lib1.so
#	extra_lib2.so
#	/usr/lib/libresolv.so
#}


#
# List of language content type declarations
#
#content-language = {
#	/hr/*		hr
#	*.hr.html	hr
#	*.hr.shtml	hr
#	/en/*		en
#	*.en.html	en
#	*.en.shtml	en
#}

#
# List of URL data handler modules
#
url-handlers = {
 	/cgi-bin/*	cgi.so
#	http:*		http_proxy.so
#	gopher:*	gopher_proxy.so
#
# The "next_proxy" relays hands over all Proxy traffic to some
# other Proxy server exactly as the data is sent to Phttpd from the client.
#	http:*		next_proxy.so
#	gopher:*	next_proxy.so
#	ftp:*		next_proxy.so
#	file:*		next_proxy.so
#	wais:*		next_proxy.so
#
	*.map		map.so
#	*.var		var.so
	*.shtml		ncsa-html.so
	*.mbox		mbox.so
	*.cgi		cgi.so
	*.nph		cgi.so
	*.asis		asis.so
	*.cgi/*		cgi.so
	*.nph/*		cgi.so
	/phttpd/config	config.so
	*/		dir.so
	*		file.so
}


#
# List of modules handling user/password authentication requests
# The first token is the "Domain" (wildcards are allowed) from the
# Authenticate header (see "read-authenticate" and "write-authenticate" below).
#
auth-handlers = {
	File*		auth_file.so
	[passwd]	auth_syspwd.so
}


## Syntax is: URL-pattern   Rewriting-Rule
#
# url-rewrites = {
#	/htbin/htimage/*	/%{2-}
# 	/cgi-bin/imagemap/*	/%{2-}
# }


## Syntax is: URL-pattern   ACL-file
#
# host-access = {
#	/Access/*	Access/.acl
# }


## Syntax is: URL-pattern   Password-Source   Security-Realm
## Where '[passwd]' == System password database
#
# read-authenticate = {
#	/Auth/*			[passwd]	System Password
#	/Secret/*		File2		Secret PassPhrase
#	/TopSecret/*		File1		TopSecret Sentence
# }
#
#
# This is default, you may want to set this to no to debug !
# write-needs-auth = yes
#
# write-authenticate = {
#	/Auth/*			[passwd]	System Password
#	/Secret/*		File2		Secret PassPhrase
#	/TopSecret/*		File1		TopSecret Sentence
# }


## Syntax is: URL-pattern   Rewriting-Rule
#
# url-redirects = {
#  	/Lysator/*	http://www.lysator.liu.se/%{1-}
# }


## Syntax is: URL-pattern   Rewriting-Rule
#
# url-permanent-redirects = {
#	/Ifm/*	http://www.ifm.liu.se/%{1-}
# }


## Syntax is: Error code	URL
## Defaults to builting pages.
#
# error-pages = {
#	403	http://www.not-found.com/
#	404	http://www.access-denied.com/
#	*	http://www.catch-all.com/
# }

</PRE>
</BODY>
</HTML>
